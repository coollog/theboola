jQuery(function(){APjs.site=new APjs.site();APjs.site.initialize();});window.APjs={};APjs.site=function(){};APjs.site.prototype={initialize:function(){if(jQuery('.ap-signup-fields #password').length>0){jQuery('.ap-signup-fields #password1').on('keyup',jQuery.proxy(this.checkPasswordMatch,this,'.ap-signup-fields #password','.ap-signup-fields #password1'));jQuery('.ap-signup-fields #password').on('keyup',jQuery.proxy(this.checkPasswordLength,this,'#password'));}
this.checkUsernameLength();this.checkUsernameAvilable();this.checkEmail();this.castVote();this.favorite();this.appendMessageBox();this.close();this.loadFlagModal();this.flagModalSubmit();this.followUser();this.dropdown();this.dropdownClose();this.load_comment_form();this.load_edit_comment_form();this.submitAnswer();this.submitQuestion();this.toggleLoginSignup();this.saveComment();this.updateComment();this.deleteComment();this.selectBestAnswer();this.deletePost();this.tab();this.labelSelect();this.saveLabel();this.tagsScript();this.tagsSuggestion();this.addTag();this.uploadForm();this.saveProfile();this.sendMessage();this.showConversation();this.newMessageButton();this.userSuggestion();this.searchMessage();this.editMessage();this.deleteMessage();this.questionSuggestion();this.flushRules();this.ajaxLoginForm();this.loadNewTagForm();this.newTag();jQuery('body').delegate('.ap-modal-bg, .ap-modal-close','click',function(){jQuery('.ap-modal.active').toggleClass('active');});jQuery('.ap-open-modal').click(function(e){e.preventDefault();var id=jQuery(this).attr('href');jQuery(id).addClass('active');});},appendMessageBox:function(){if(jQuery('#ap-messagebox').length=='0')
jQuery('body').append('<div id="ap-messagebox"></div>');},showLoading:function(message){if(typeof message=='undefined')message=aplang.loading;if(jQuery('#ap-ajax-loading').length>0)
jQuery('#ap-ajax-loading').text(message);else
jQuery('#ap-messagebox').append('<div style="display:none" id="ap-ajax-loading">'+message+'</div>');jQuery('#ap-ajax-loading').slideDown(200);},addMessage:function(message,type){jQuery('<div class="ap-message-item '+type+'">'+message+'</div>').appendTo('#ap-messagebox').delay(5000).slideUp(200);},hideLoading:function(){jQuery('#ap-ajax-loading').delay(500).slideUp(200);},fieldValidationClass:function(field,vclass){jQuery(field).addClass(vclass);},helpBlock:function(elm,message){if(jQuery(elm).find('.help-block').length>0)
jQuery(elm).find('.help-block').remove();jQuery(elm).append('<span class="help-block">'+message+'</span>');},toggleFormSubmission:function(form,toggle){if(toggle&&jQuery(form).find('.has-error').length==0)
jQuery(form).find('button[type="submit"]').removeAttr('disabled');else
jQuery(form).find('button[type="submit"]').attr('disabled','disabled');},isEmail:function(email){var regex=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return regex.test(email);},checkPasswordMatch:function(field1,field2){var password=jQuery(field1).val();var confirmPassword=jQuery(field2).val();var parent=jQuery(field2).closest('.form-group');if(password!=confirmPassword){this.fieldValidationClass(parent,'has-error');if(parent.find('.help-block').length==0)
this.helpBlock(parent,aplang.password_field_not_macthing);this.toggleFormSubmission(jQuery(field2).closest('form'),false);}
else{parent.removeClass('has-error');this.fieldValidationClass(parent,'has-feedback');if(parent.find('.help-block').length>0)
parent.find('.help-block').remove();this.toggleFormSubmission(jQuery(field2).closest('form'),true);}},checkPasswordLength:function(field){var password=jQuery(field).val(),parent=jQuery(field).closest('.form-group');if(password.length<6){this.fieldValidationClass(parent,'has-error');this.helpBlock(parent,aplang.password_length_less);this.toggleFormSubmission(jQuery(field).closest('form'),false);}else{parent.removeClass('has-error');this.fieldValidationClass(parent,'has-feedback');parent.find('.help-block').remove();this.toggleFormSubmission(jQuery(field).closest('form'),true);}},checkEmail:function(field){var self=this;jQuery('.anspress').delegate('form #email','keyup blur',function(){var field=jQuery(this);var parent=jQuery(field).closest('.form-group');if(!self.isEmail(field.val())){self.fieldValidationClass(parent,'has-error');if(parent.find('.help-block').length==0)
self.helpBlock(parent,aplang.not_valid_email);self.toggleFormSubmission(jQuery(field).closest('form'),false);}
else{parent.removeClass('has-error');self.fieldValidationClass(parent,'has-feedback');if(parent.find('.help-block').length>0)
parent.find('.help-block').remove();self.toggleFormSubmission(jQuery(field).closest('form'),true);}});},checkUsernameLength:function(){var self=this;jQuery('.anspress').delegate('#ap_signup_modal #username','keyup blur',function(){var field=jQuery(this);var parent=field.closest('.form-group');if(field.val().length<=4){self.fieldValidationClass(parent,'has-error');if(parent.find('.help-block').length==0)
self.helpBlock(parent,aplang.username_less);self.toggleFormSubmission(field.closest('form'),false);}
else{parent.removeClass('has-error');self.fieldValidationClass(parent,'has-feedback');if(parent.find('.help-block').length>0)
parent.find('.help-block').remove();self.toggleFormSubmission(field.closest('form'),true);}});},checkUsernameAvilable:function(){var self=this;jQuery('.anspress').delegate('#ap_signup_modal #username','blur',function(){var field=jQuery(this);var parent=field.closest('.form-group');jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_check_username',username:jQuery(field).val(),},context:this,success:function(data){if(data=='true'){parent.removeClass('has-error');self.fieldValidationClass(parent,'has-feedback');if(parent.find('.help-block').length>0)
parent.find('.help-block').remove();self.toggleFormSubmission(field.closest('form'),true);}else{self.fieldValidationClass(parent,'has-error');if(parent.find('.help-block').length==0)
self.helpBlock(parent,aplang.username_not_avilable);self.toggleFormSubmission(field.closest('form'),false);}}});});},checkEmailAvilable:function(){var self=this;jQuery('.anspress').delegate('form #email','blur',function(){var field=jQuery(this);var parent=field.closest('.form-group');if(!jQuery(parent).is('.has-error'))
jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_check_email',email:jQuery(field).val(),},context:this,success:function(data){if(data=='true'){parent.removeClass('has-error');self.fieldValidationClass(parent,'has-feedback');if(parent.find('.help-block').length>0)
parent.find('.help-block').remove();self.toggleFormSubmission(field.closest('form'),true);}else{self.fieldValidationClass(parent,'has-error');if(parent.find('.help-block').length==0)
self.helpBlock(parent,aplang.email_already_in_use);self.toggleFormSubmission(field.closest('form'),false);}}});});},doAjaxForm:function(data,callback,context){context=typeof context!=='undefined'?context:false;callback=typeof callback!=='undefined'?callback:false;return jQuery.ajax({type:'POST',url:ajaxurl,data:data,dataType:'json',context:context,success:callback});},castVote:function(){var self=this;jQuery('.anspress').delegate('[data-action="vote"] a','click',function(e){e.preventDefault();var args=jQuery(this).data('args');self.showLoading(aplang.voting_on_post);jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_vote_on_post',args:args,},dataType:'json',context:this,success:function(result,textStatus,XMLHttpRequest){self.hideLoading();if(result['action']=='voted'||result['action']=='undo'){if(result['action']=='voted'){jQuery(this).addClass('voted');if(result['type']=='up')jQuery(this).parent().find('.vote-down').addClass('disable');if(result['type']=='down')jQuery(this).parent().find('.vote-up').addClass('disable');}
else if(result['action']=='undo'){jQuery(this).removeClass('voted');if(result['type']=='up')jQuery(this).parent().find('.vote-down').removeClass('disable');if(result['type']=='down')jQuery(this).parent().find('.vote-up').removeClass('disable');}
jQuery(this).parent().find('.net-vote-count').text(result['count']);self.addMessage(result['message'],'success');}else{self.addMessage(result['message'],'error');}}});});},favorite:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-favorite"]','click',function(e){e.preventDefault();self.showLoading(aplang.adding_to_fav);var args=jQuery(this).data('args');jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_add_to_favorite',args:args,},dataType:'json',context:this,success:function(data){self.hideLoading();if(data['action']=='added'||data['action']=='removed'){if(data['action']=='added')jQuery(this).addClass('added');else if(data['action']=='removed')jQuery(this).removeClass('added');jQuery(this).html(data['count']);jQuery(this).attr('title',data['title']);jQuery(this).parent().find('span').html(data['text']);self.addMessage(data['message'],'success');}else{self.addMessage(data['message'],'error');}},error:function(MLHttpRequest,textStatus,errorThrown){alert(errorThrown);}});});},close:function(){var self=this;jQuery('.anspress').delegate('[data-action="close-question"]','click',function(e){e.preventDefault();var args=jQuery(this).data('args');self.showLoading(aplang.requesting_for_closing);jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_vote_for_close',args:args,},dataType:'json',context:this,success:function(result){self.hideLoading();if(result['row']){if(result['action']=='added')
jQuery(this).addClass('closed');else if(result['action']=='removed')
jQuery(this).removeClass('closed');jQuery(this).text(result['text']);jQuery(this).attr('title',result['title']);self.addMessage(result['message'],'success');}else{self.addMessage(result['message'],'error');}},error:function(MLHttpRequest,textStatus,errorThrown){alert(errorThrown);}});});},modalShow:function(id){jQuery('.ap-modal').addClass('active');},loadFlagModal:function(){var self=this;jQuery('.anspress').delegate('[data-action="flag-modal"]','click',function(e){e.preventDefault();if(!jQuery(this).is('.loaded')){var args=jQuery(this).data('args');self.showLoading();jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_flag_note_modal',args:args,},context:this,success:function(data){self.hideLoading();jQuery(data).appendTo('body');self.modalShow(jQuery(this).attr('href'));jQuery(this).addClass('loaded');},error:function(MLHttpRequest,textStatus,errorThrown){alert(errorThrown);}});}else{self.modalShow(jQuery(this).attr('href'));}});jQuery('body').delegate(':radio[name="note_id"]','click',function(){jQuery(':radio[name="note_id"]').closest('.note').removeClass('active');jQuery(this).closest('.note').addClass('active');});},flagModalSubmit:function(){var self=this;jQuery('body').delegate('#submit-flag-question','click',function(e){e.preventDefault();var args=jQuery(this).data('args');var note_id=jQuery(this).closest('.flag-note').find(':radio[name="note_id"]:checked').val();var other_note=jQuery(this).closest('.flag-note').find('#other-note').val();self.showLoading(aplang.sending_request);jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_submit_flag_note',args:args,note_id:note_id,other_note:other_note,},dataType:'json',context:this,success:function(result){self.hideLoading();var id=jQuery(this).closest('.flag-note').attr('id');var to_update=jQuery('#flag_'+jQuery(this).data('update'));jQuery('#'+id).removeClass('active');if(result['row']=='1'){if(result['action']=='flagged')to_update.addClass('flagged');to_update.text(result['text']);to_update.attr('title',result['title']);self.addMessage(result['message'],'success');}else{self.addMessage(result['message'],'error');}},error:function(MLHttpRequest,textStatus,errorThrown){alert(errorThrown);}});});},followUser:function(){var self=this;jQuery('.ap-container').delegate('[data-action="ap-follow"]','click',function(e){e.preventDefault();var args=jQuery(this).data('args');self.showLoading(aplang.sending_request);jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_follow',args:args},dataType:'json',context:this,success:function(data){self.hideLoading();if(data['action']=='pleazelogin'){self.addMessage(data['message'],'error');}else if(data['action']=='follow'){jQuery(this).text(data['text']);jQuery(this).attr('title',data['title']);jQuery(this).removeClass('ap-icon-plus');jQuery(this).addClass('ap-unfollow ap-icon-minus');jQuery('[data-id="'+data['id']+'"] [data-view="ap-followers"]').text(data['followers_count']);self.addMessage(data['message'],'success');}else if(data['action']=='unfollow'){jQuery(this).text(data['text']);jQuery(this).attr('title',data['title']);jQuery(this).removeClass('ap-unfollow ap-icon-minus');jQuery(this).addClass('ap-icon-plus');jQuery('[data-id="'+data['id']+'"] [data-view="ap-followers"]').text(data['followers_count']);self.addMessage(data['message'],'success');}else{self.addMessage(data['message'],'error');}},error:function(MLHttpRequest,textStatus,errorThrown){alert(errorThrown);}});});},dropdown:function(){jQuery('.anspress').delegate('.ap-dropdown-toggle','click',function(e){e.preventDefault();jQuery(this).closest('.ap-dropdown').toggleClass('open');});jQuery('.anspress').delegate('.ap-dropdown-menu a','click',function(e){jQuery(this).closest('.ap-dropdown').removeClass('open');});},dropdownClose:function(){jQuery('[data-toggle="ap-dropdown"]').click(function(e){e.preventDefault();jQuery(this).closest('.ap-dropdown').removeClass('open');});},load_comment_form:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-load-comment"]','click',function(e){e.preventDefault();var args=jQuery(this).data('args'),elem=jQuery(this).attr('href');if(jQuery(elem).length===0)
jQuery(this).closest('ul').after('<div id="'+elem.replace('#','')+'"></div>');if(jQuery(this).is('.ajax-done')){jQuery(elem+' #respond').slideToggle();}else{self.showLoading(aplang.loading_comment_form);jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_load_comment_form',args:args,},context:this,success:function(data){self.hideLoading();if(jQuery('.comment-form-c').length>0)
jQuery('.comment-form-c').remove();jQuery(elem).append(data);jQuery(this).addClass('ajax-done');jQuery('html, body').animate({scrollTop:(jQuery('#respond').offset().top)-50},500);},error:function(MLHttpRequest,textStatus,errorThrown){alert(errorThrown);}});}});},load_edit_comment_form:function(){var self=this;jQuery('body').delegate('[data-button="ap-edit-comment"]','click',function(e){e.preventDefault();var args=jQuery(this).data('args');self.showLoading(aplang.loading_comment_form);jQuery.ajax({url:ajaxurl,data:{action:'ap_edit_comment_form',args:args,},context:this,success:function(data,textStatus,XMLHttpRequest){self.hideLoading();if(jQuery(data).selector=='not_logged_in'){ap_not_logged_in();}else{jQuery(this).closest('.comment-content').html(data);}}});});},updateView:function(data,text){jQuery('[data-view="'+data+'"]').text(text);},submitAnswer:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-submit-answer"]','submit',function(e){var form=jQuery(this);var btn=jQuery(this).find('.btn-submit-ans');btn.attr('disabled','disabled').addClass('disabled');var fields=jQuery(this).serialize();self.showLoading(aplang.submitting_your_answer);jQuery.post(ajaxurl,fields+'&action=ap_submit_answer',function(responce){btn.removeAttr('disabled').removeClass('disabled');self.hideLoading();if(responce['action']=='new_answer'){form[0].reset();if(!responce['can_answer'])
jQuery('#answer-form-c').hide();jQuery('[data-view="ap-answer-count"]').text(responce['count']);jQuery('[data-view="ap-answer-count-label"]').text(responce['count_label']);self.addMessage(responce['message'],'success');if(jQuery('#answers').length===0){jQuery('#question').after(jQuery(responce['html']));jQuery(responce['div_id']).hide();}else
jQuery('#answers').append(jQuery(responce['html']).hide());jQuery(responce['div_id']).slideDown(500);if(typeof responce['redirect_to']!=='undefined')
window.location.replace(responce['redirect_to']);}else if(responce['action']=='answer_edited'){self.addMessage(responce['message'],'success');if(typeof responce['redirect_to']!=='undefined')
window.location.replace(responce['redirect_to']);}else if(responce['action']=='validation_falied'){self.addMessage(responce['message'],'error');self.appendFormError('#answer_form',responce['error']);}else{self.addMessage(responce['message'],'error');}},'json');return false});},submitQuestion:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-submit-question"]','submit',function(e){var form=jQuery(this);var btn=jQuery(this).find('.btn-submit-ask');btn.attr('disabled','disabled').addClass('disabled');var fields=jQuery(this).serialize();self.showLoading(aplang.submitting_your_question);jQuery.post(ajaxurl,fields+'&action=ap_submit_question',function(responce){btn.removeAttr('disabled').removeClass('disabled');self.hideLoading();if(responce['action']=='new_question'||responce['action']=='edited_question'){form[0].reset();self.addMessage(responce['message'],'success');window.location.replace(responce['redirect_to']);}else if(responce['action']=='validation_falied'){self.clearError('#ask_question_form');self.addMessage(responce['message'],'error');self.appendFormError('#ask_question_form',responce['error']);if(typeof responce['error']['recaptcha_response_field']!=='undefined'){var errorString="&error="+encodeURIComponent(responce['error']['recaptcha_response_field']);Recaptcha.create(recaptch_public+errorString,"recaptcha",{theme:"clean",callback:Recaptcha.focus_response_field});console.log(errorString);}}else{self.addMessage(responce['message'],'error');}
jQuery(this).trigger('submitQuestion',responce);},'json');return false});},appendFormError:function(form,error){var self=this;if(typeof error!=='undefined'){jQuery.each(error,function(i,message){var parent=jQuery(form).find('#'+i).closest('.form-group');parent.addClass('has-error');self.helpBlock(parent,message);});}},clearError:function(form){jQuery(form).find('.has-error').removeClass('has-error');jQuery(form).find('.help-block').remove();},toggleLoginSignup:function(){jQuery('.anspress').delegate('[data-toggle="ap-signup-form"]','click',function(e){e.preventDefault();jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_toggle_login_signup',args:jQuery(this).data('args'),},context:this,success:function(data){jQuery('#ap-login-signup').empty().append(data);}});});},saveComment:function(){var self=this;jQuery('.anspress').delegate('#commentform','submit',function(){var form=jQuery(this);var fields=jQuery(this).serialize();self.showLoading(aplang.submitting_your_comment);jQuery.post(jQuery(this).attr('action'),fields,function(responce){self.hideLoading();form[0].reset();if(responce['status']&&jQuery('#li-comment-'+responce['comment_ID']).length==0){jQuery('#comments-'+responce['comment_post_ID']+' ul.commentlist').append(jQuery(responce['html']).hide().slideDown(300));self.addMessage(responce['message'],'success');}},'json');return false});},deleteComment:function(){var self=this;jQuery('.anspress').delegate('[data-button="ap-delete-comment"]','click',function(e){e.preventDefault();if(confirm(jQuery(this).data('confirm'))){var args=jQuery(this).data('args');self.showLoading(aplang.deleting_comment);jQuery.ajax({url:ajaxurl,data:{action:'ap_delete_comment',args:args,},context:this,dataType:'json',success:function(data){self.hideLoading();if(data['status']){jQuery(this).closest('li.comment').remove();self.addMessage(data['message'],'success');}else{self.addMessage(data['message'],'error');}}});}});},updateComment:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-edit-comment"]','submit',function(e){e.preventDefault();self.showLoading(aplang.updating_comment);jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_update_comment',args:jQuery(this).serialize(),},context:this,dataType:'json',success:function(data){self.hideLoading();if(data['status']){var item=jQuery(this).closest('li');jQuery(item).after(data['html']);item.remove();self.addMessage(data['message'],'success');}else{self.addMessage(data['message'],'error');}}});return false;});},selectBestAnswer:function(){var self=this;jQuery('.anspress').delegate('[data-button="ap-select-answer"]','click',function(e){e.preventDefault();self.showLoading();jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_set_best_answer',args:jQuery(this).data('args'),},context:this,dataType:'json',success:function(data){self.hideLoading();if(data['action']=='selected'){jQuery('[data-button="ap-select-answer"]').not(this).hide();jQuery(this).after(data['html']);jQuery(this).closest('.answer').addClass('selected');jQuery(this).remove();self.addMessage(data['message'],'success');}else if(data['action']=='unselected'){jQuery(this).after(data['html']);jQuery(this).closest('.answer').removeClass('selected');jQuery(this).remove();self.addMessage(data['message'],'success');}else{self.addMessage(data['message'],'error');}}});});},deletePost:function(){var self=this;jQuery('.anspress').delegate('[data-button="ap-delete-post"]','click',function(e){e.preventDefault();self.showLoading(aplang.deleting_post);jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_delete_post',args:jQuery(this).data('args'),},context:this,dataType:'json',success:function(data){self.hideLoading();if(data['action']=='question'){self.addMessage(data['message'],'success');window.location.replace(data['redirect_to']);}else if(data['action']=='answer'){self.addMessage(data['message'],'success');self.updateView('ap-answer-count-label',data['count_label']);self.updateView('ap-answer-count',data['count']);if(!data['remove'])
jQuery(data['div']).slideUp(200);else
jQuery('#answers-c').remove();}else{self.addMessage(data['message'],'error');}}});});},loadEditForm:function(){var self=this;jQuery('.anspress').delegate('[data-button="ap-edit-post"]','click',function(e){e.preventDefault();self.showLoading(aplang.loading_form);jQuery.ajax({type:'POST',url:ajaxurl,data:jQuery(this).data('args'),context:this,dataType:'json',success:function(data){self.hideLoading();if(data['action']){self.addMessage(data['message'],'success');jQuery('#ap-single').html(data['html']);}else{self.addMessage(data['message'],'error');}}});});},tab:function(){jQuery('[data-action="ap-tab"] a').click(function(e){e.preventDefault();var current=jQuery(this).closest('ul').find('.active a').attr('href');var div=jQuery(this).attr('href');jQuery(current).removeClass('active');jQuery(this).closest('ul').find('li').removeClass('active');jQuery(this).parent().addClass('active');jQuery(div).addClass('active');});},labelSelect:function(){jQuery('.anspress').delegate('[data-action="ap-label-select"] li:not(.ap-select-footer)','click',function(e){e.preventDefault();jQuery(this).toggleClass('selected');});},saveLabel:function(){var self=this;jQuery('.anspress').delegate('[data-button="ap-save-label"]','click',function(e){e.preventDefault();self.showLoading(aplang.saving_labels);var args=[];jQuery(this).closest('ul').find('li.selected').each(function(i){args[i]=jQuery(this).data('args');});jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_save_labels',args:args,id:jQuery(this).data('id'),nonce:jQuery(this).data('nonce')},context:this,dataType:'json',success:function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');jQuery(this).closest('.ap-dropdown').removeClass('open');jQuery('[data-view="ap-labels-list"]').html(jQuery(data['html']));jQuery('[data-view="ap-labels-list"]').find('li').hide()
var i=1;jQuery('[data-view="ap-labels-list"]').find('li').each(function(){jQuery(this).delay(i*100).slideDown(300);i++;});}else{self.addMessage(data['message'],'error');}}});});},tagsScript:function(){if(jQuery('[data-role="ap-tagsinput"]').length>0){jQuery('[data-role="ap-tagsinput"]').tagsinput({freeInput:false,maxTags:ap_max_tags,});jQuery('[data-role="ap-tagsinput"]').tagsinput('input').blur(function(e){jQuery(document).mouseup(function(e){var container=jQuery('#ap-suggestions');if(!container.is(e.target)&&container.has(e.target).length===0){container.hide();}});});}},tagsSuggestion:function(){this.tagsquery;var self=this;jQuery('.anspress').delegate('#ask_question_form .bootstrap-tagsinput input','keyup',function(){var value=jQuery(this).val();if(value.length==0)
return;if(typeof self.tagsquery!=='undefined'){self.tagsquery.abort();}
self.showLoading(aplang.loading_suggestions);self.tagsquery=jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_suggest_tags',q:value},context:this,dataType:'json',success:function(data){self.hideLoading();var container=jQuery(this).closest('.bootstrap-tagsinput'),position=container.offset();if(jQuery('#ap-suggestions').length==0)
jQuery('.anspress').append('<div id="ap-suggestions" class="ap-suggestions" style="display:none"></div>');if(data['items']){self.tagItems(data['items']);jQuery('#ap-suggestions').html(self.tagsitems+data['form']).css({'top':(position.top+container.height()+20),'left':position.left,'width':container.width()}).show();}else if(data['form']){jQuery('#ap-suggestions').html(data['form']).css({'top':(position.top+container.height()+20),'left':position.left,'width':container.width()}).show();}}});});},tagItems:function(items){this.tagsitems='';var self=this;jQuery.each(items,function(i){self.tagsitems+='<div class="ap-tag-item" data-action="ap-add-tag" data-name="'+this.name+'"><div class="ap-tag-item-inner">';self.tagsitems+='<div class="tag-title"><strong>'+this.name+'</strong> &times; <span>'+this.count+'</span></div>';self.tagsitems+='<span class="tag-description">'+this.description+'</strong>';self.tagsitems+='</div></div>';});},addTag:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-add-tag"]','click touchstart',function(){jQuery('[data-role="ap-tagsinput"]').tagsinput('add',jQuery(this).data('name'));jQuery('[data-role="ap-tagsinput"]').tagsinput('input').val('');jQuery('#ap-suggestions').hide();});},uploadForm:function(){var self=this;jQuery('[data-action="ap-upload-field"]').change(function(){jQuery(this).closest('form').submit();});jQuery('[data-action="ap-upload-form"]').submit(function(){jQuery(this).ajaxSubmit({beforeSubmit:function(){self.showLoading(aplang.uploading);},success:function(data){self.hideLoading();jQuery('body').trigger('uploadForm',data);if(data['status']){self.addMessage(data['message'],'success');}else{self.addMessage(data['message'],'error');}},url:ajaxurl,dataType:'json'});return false});jQuery('body').on('uploadForm',function(e,data){if(data['view']=='[data-view="cover"]')
jQuery(data['view']).attr('style',data['background-image']);else if(data['view']=='[data-view="avatar-main"]')
jQuery(data['view']).html(data['image']);});},saveProfile:function(){var self=this;jQuery('[data-action="ap-edit-profile"]').submit(function(){jQuery(this).ajaxSubmit({beforeSubmit:function(){self.showLoading(aplang.saving_profile);},success:function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');}else if(responce['action']=='validation_falied'){self.clearError('#ask_question_form');self.addMessage(responce['message'],'error');self.appendFormError('#ask_question_form',responce['error']);}else{self.addMessage(data['message'],'error');}},url:ajaxurl,dataType:'json'});return false;});},sendMessage:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-send-message"]','submit',function(){jQuery(this).ajaxSubmit({beforeSubmit:function(){self.showLoading(aplang.sending_message);},success:function(data){self.hideLoading();if(data['status']==true){self.addMessage(data['message'],'success');var container=jQuery('[data-view="conversation"] > ul');if(container.length==0){jQuery('[data-view="conversation"]').html(jQuery(data['html']).hide());jQuery('[data-view="conversation"] > ul').slideDown(200);jQuery('[data-view="conversation"] > form').slideDown(200);}else{container.append(jQuery(data['html']).hide());container.find('li:last-child').slideDown(200);}
jQuery('textarea.autogrow').autogrow({onInitialize:true});}else if(data['status']=='validation_falied'){self.clearError(this);self.addMessage(data['message'],'error');self.appendFormError(this,data['error']);}else{self.addMessage(data['message'],'error');}},url:ajaxurl,dataType:'json',clearForm:true,context:this});return false;});},showConversation:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-show-conversation"]','click',function(e){e.preventDefault();self.showLoading(aplang.loading_conversation);jQuery(this).parent().find('li.active').removeClass('active');jQuery(this).addClass('active');jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_show_conversation',args:jQuery(this).data('args')},context:this,dataType:'json',success:function(data){self.hideLoading();if(data['status']){jQuery('[data-view="conversation"]').html(data['html']);self.addMessage(data['message'],'success');}
else{self.addMessage(data['message'],'error');}}});});if(!ap_url_string_value('to'))
jQuery('[data-action="ap-show-conversation"].active').click();},newMessageButton:function(){var self=this;jQuery('.anspress').delegate('[data-button="ap-new-message"]','click',function(e){e.preventDefault();self.showLoading(aplang.loading_new_message_form);jQuery.ajax({type:'POST',url:ajaxurl,data:{action:'ap_new_message_form'},context:this,dataType:'json',success:function(data){self.hideLoading();if(data['status']){jQuery('[data-view="conversation"]').html(data['html']);jQuery('textarea.autogrow').autogrow({onInitialize:true});jQuery('[data-action="ap-suggest-user"]').tagsinput({freeInput:false,itemValue:'value',itemText:'text',});jQuery('[data-action="ap-suggest-user"]').tagsinput('input').blur(function(e){jQuery(document).mouseup(function(e){var container=jQuery('#ap-suggestions');if(!container.is(e.target)&&container.has(e.target).length===0){container.hide();}});});}}});});if(ap_url_string_value('to'))
jQuery('[data-button="ap-new-message"]').click();},userSuggestion:function(){this.usersquery;var self=this;jQuery('.anspress').delegate('[data-action="ap-add-user"]','click',function(){jQuery('[data-action="ap-suggest-user"]').tagsinput('add',{"value":jQuery(this).data('id'),"text":jQuery(this).data('name')});jQuery('[data-action="ap-suggest-user"]').tagsinput('input').val('');jQuery('#ap-suggestions').hide();});jQuery('.anspress').delegate('#ap-new-message .bootstrap-tagsinput input','keyup',function(){var value=jQuery(this).val();if(value.length==0)
return;if(typeof self.usersquery!=='undefined'){self.usersquery.abort();}
self.showLoading(aplang.loading_suggestions);self.usersquery=self.doAjaxForm({action:'ap_search_users',q:value},function(data){self.hideLoading();var container=jQuery(this).closest('.bootstrap-tagsinput'),position=container.offset();if(jQuery('#ap-suggestions').length==0)
jQuery('.anspress').append('<div id="ap-suggestions" class="ap-suggestions user-suggestions" style="display:none"></div>');if(data['items']){self.userItems(data['items']);jQuery('#ap-suggestions').html(self.useritems).css({'top':(position.top+container.height()+20),'left':position.left}).show();}},this);});},userItems:function(items){this.useritems='';var self=this;jQuery.each(items,function(i){self.useritems+='<div class="ap-suggestion-user" data-action="ap-add-user" data-name="'+this.name+'" data-id="'+this.id+'"><div class="ap-user-item-inner clearfix">';self.useritems+='<div class="suggestion-avatar">'+this.avatar+'</div>';self.useritems+='<span class="name">'+this.name+'</strong>';self.useritems+='</div></div>';});},loadMoreConversations:function(elem){var self=this;self.showLoading(aplang.loading_more_conversations);var offset=jQuery(elem).attr('data-offset');if(typeof offset!=='undefined')
self.doAjaxForm({action:'ap_load_conversations',offset:offset,args:jQuery(elem).attr('data-args')},function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');jQuery(elem).attr('data-offset',parseInt(offset)+1);jQuery('#ap-conversation-scroll ul').append(jQuery(data['html']).html());jQuery('#ap-conversation-scroll').perfectScrollbar('update');}else{self.addMessage(data['message'],'error');}});},searchMessage:function(){var self=this;jQuery('.anspress').delegate('[data-action="ap-search-conversations"]','keyup',function(){var value=jQuery(this).val();if(value.length==0)
return;if(typeof self.messageSearchXhr!=='undefined'){self.messageSearchXhr.abort();}
jQuery(this).closest('form').submit();});jQuery('[data-role="ap-search-conversations"]').submit(function(){self.messageSearch=jQuery(this).ajaxSubmit({beforeSubmit:function(){self.showLoading(aplang.searching_conversations);},success:function(data){self.hideLoading();if(data['status']){jQuery(this).removeAttr('data-offset');jQuery('#ap-conversation-scroll ul').html(jQuery(data['html']).html());jQuery('#ap-conversation-scroll').perfectScrollbar('update');}else{self.addMessage(data['message'],'error');}},url:ajaxurl,dataType:'json',type:'GET'});self.messageSearchXhr=self.messageSearch.data('jqxhr');return false;});},editMessage:function(){var self=this;jQuery('.anspress').delegate('[data-button="ap-edit-message"]','click',function(e){e.preventDefault();self.showLoading(aplang.loading_message_edit_form);self.doAjaxForm({action:'ap_message_edit_form',args:jQuery(this).data('args')},function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');jQuery(this).closest('.ap-message').find('[data-view="ap-message-content"]').html(data['html']);jQuery('textarea.autogrow').autogrow({onInitialize:true});}else{self.addMessage(data['message'],'error');}},this);});jQuery('.anspress').delegate('[data-action="ap-edit-message"]','submit',function(){jQuery(this).ajaxSubmit({beforeSubmit:function(){self.showLoading(aplang.updating_message);},success:function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');jQuery(this).after(data['html']);jQuery(this).remove();}else{self.addMessage(data['message'],'error');}},url:ajaxurl,dataType:'json',type:'POST',context:this});return false;});},deleteMessage:function(){var self=this;jQuery('.anspress').delegate('[data-button="ap-delete-message"]','click',function(e){e.preventDefault();self.showLoading(aplang.deleting_message);self.doAjaxForm({action:'ap_delete_message',args:jQuery(this).data('args')},function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');jQuery(this).closest('.ap-message').remove();}else{self.addMessage(data['message'],'error');}},this);});},questionSuggestion:function(){this.qquery;var self=this;jQuery('.anspress').delegate('#ap-quick-ask-input','keyup',function(){var value=jQuery(this).val();if(value.length==0)
return;if(typeof self.qquery!=='undefined'){self.qquery.abort();}
self.showLoading(aplang.loading_suggestions);self.qquery=self.doAjaxForm({action:'ap_suggest_questions',q:value},function(data){self.hideLoading();var container=jQuery(this).closest('.ap-qaf-inner'),position=container.offset();if(jQuery('#ap-qsuggestions').length==0)
jQuery('.anspress').append('<div id="ap-qsuggestions" class="ap-qsuggestions" style="display:none"></div>');if(data['items']){self.qsItems(data['items']);jQuery('#ap-qsuggestions').html(self.qsitems).css({'top':(position.top+container.height()+10),'left':position.left,'width':container.width()}).show();}},this);});jQuery('.anspress').delegate('#ap-qsuggestions','click',function(e){jQuery('#ap-qsuggestions').toggle();});},qsItems:function(items){this.qsitems='';var self=this;jQuery.each(items,function(i){self.qsitems+=this.html;});},flushRules:function(){var self=this;jQuery('.ap-missing-rules > a').click(function(e){e.preventDefault();self.showLoading(aplang.sending);self.doAjaxForm({action:'ap_install_rewrite_rules',args:jQuery(this).data('args')},function(){self.hideLoading();jQuery('.ap-missing-rules').hide();});});},submitAjaxForm:function(form,before,after){jQuery('.anspress').delegate(form,'submit',function(){jQuery(this).ajaxSubmit({beforeSubmit:before,success:after,url:ajaxurl,dataType:'json'});return false;});},ajaxLoginForm:function(){var self=this;self.submitAjaxForm('#ap-login-form',function(){self.showLoading(aplang.sending);},function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');jQuery('.ap-account-button').remove();location.reload();}else{self.addMessage(data['message'],'error');}});self.submitAjaxForm('#ap-signup-form',function(){self.showLoading(aplang.sending);},function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');jQuery('#ap_signup_modal').toggleClass('active');jQuery('#ap_login_modal').toggleClass('active');jQuery('#ap-login-form').prepend('<strong>'+data['message']+'</strong>');}else{self.addMessage(data['message'],'error');}});},loadNewTagForm:function(){var self=this;jQuery('.anspress').delegate('#ap-load-new-tag-form','click',function(e){e.preventDefault();self.showLoading(aplang.loading);self.doAjaxForm({action:'ap_load_new_tag_form',args:jQuery(this).data('args')},function(data){self.hideLoading();if(data['status']){jQuery(this).closest('.ap-suggestions').html(data['html']);}else{self.addMessage(data['message'],'error');}},this);});},newTag:function(){var self=this;self.submitAjaxForm('#ap_new_tag_form',function(){self.showLoading(aplang.sending);},function(data){self.hideLoading();if(data['status']){self.addMessage(data['message'],'success');jQuery('[data-role="ap-tagsinput"]').tagsinput('add',data['tag']['slug']);jQuery('[data-role="ap-tagsinput"]').tagsinput('input').val('');jQuery('#ap-suggestions').hide();}else{self.addMessage(data['message'],'error');}});}};function ap_label_select_template(state){var color=jQuery(state.element).data('color');if(!color)color='#ddd';return"<span class='question-label-color' style='background:"+color+"'></span>"+state.text;}
jQuery(document).ready(function(){jQuery(document).mouseup(function(e)
{var container=jQuery('#ap-qsuggestions');if(!container.is(e.target)&&container.has(e.target).length===0)
{container.hide();}});if(typeof QTags!=='undefined')
QTags.addButton('ap_code','code block','<pre>','</pre>','q');});function ap_url_string_value(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return results==null?false:decodeURIComponent(results[1].replace(/\+/g," "));};;(function(e,t,n){function s(t,n){this.bodyOverflowX;this.callbacks={hide:[],show:[]};this.checkInterval=null;this.Content;this.$el=e(t);this.$elProxy;this.elProxyPosition;this.enabled=true;this.options=e.extend({},i,n);this.mouseIsOverProxy=false;this.namespace="tooltipster-"+Math.round(Math.random()*1e5);this.Status="hidden";this.timerHide=null;this.timerShow=null;this.$tooltip;this.options.iconTheme=this.options.iconTheme.replace(".","");this.options.theme=this.options.theme.replace(".","");this._init()}function o(t,n){var r=true;e.each(t,function(e,i){if(typeof n[e]==="undefined"||t[e]!==n[e]){r=false;return false}});return r}function f(){return!a&&u}function l(){var e=n.body||n.documentElement,t=e.style,r="transition";if(typeof t[r]=="string"){return true}v=["Moz","Webkit","Khtml","O","ms"],r=r.charAt(0).toUpperCase()+r.substr(1);for(var i=0;i<v.length;i++){if(typeof t[v[i]+r]=="string"){return true}}return false}var r="tooltipster",i={animation:"fade",arrow:true,arrowColor:"",autoClose:true,content:null,contentAsHTML:false,contentCloning:true,debug:true,delay:200,minWidth:0,maxWidth:null,functionInit:function(e,t){},functionBefore:function(e,t){t()},functionReady:function(e,t){},functionAfter:function(e){},icon:"(?)",iconCloning:true,iconDesktop:false,iconTouch:false,iconTheme:"tooltipster-icon",interactive:false,interactiveTolerance:350,multiple:false,offsetX:0,offsetY:0,onlyOne:false,position:"top",positionTracker:false,speed:350,timer:0,theme:"tooltipster-default",touchDevices:true,trigger:"hover",updateAnimation:true};s.prototype={_init:function(){var t=this;if(n.querySelector){if(t.options.content!==null){t._content_set(t.options.content)}else{var r=t.$el.attr("title");if(typeof r==="undefined")r=null;t._content_set(r)}var i=t.options.functionInit.call(t.$el,t.$el,t.Content);if(typeof i!=="undefined")t._content_set(i);t.$el.removeAttr("title").addClass("tooltipstered");if(!u&&t.options.iconDesktop||u&&t.options.iconTouch){if(typeof t.options.icon==="string"){t.$elProxy=e('<span class="'+t.options.iconTheme+'"></span>');t.$elProxy.text(t.options.icon)}else{if(t.options.iconCloning)t.$elProxy=t.options.icon.clone(true);else t.$elProxy=t.options.icon}t.$elProxy.insertAfter(t.$el)}else{t.$elProxy=t.$el}if(t.options.trigger=="hover"){t.$elProxy.on("mouseenter."+t.namespace,function(){if(!f()||t.options.touchDevices){t.mouseIsOverProxy=true;t._show()}}).on("mouseleave."+t.namespace,function(){if(!f()||t.options.touchDevices){t.mouseIsOverProxy=false}});if(u&&t.options.touchDevices){t.$elProxy.on("touchstart."+t.namespace,function(){t._showNow()})}}else if(t.options.trigger=="click"){t.$elProxy.on("click."+t.namespace,function(){if(!f()||t.options.touchDevices){t._show()}})}}},_show:function(){var e=this;if(e.Status!="shown"&&e.Status!="appearing"){if(e.options.delay){e.timerShow=setTimeout(function(){if(e.options.trigger=="click"||e.options.trigger=="hover"&&e.mouseIsOverProxy){e._showNow()}},e.options.delay)}else e._showNow()}},_showNow:function(n){var r=this;r.options.functionBefore.call(r.$el,r.$el,function(){if(r.enabled&&r.Content!==null){if(n)r.callbacks.show.push(n);r.callbacks.hide=[];clearTimeout(r.timerShow);r.timerShow=null;clearTimeout(r.timerHide);r.timerHide=null;if(r.options.onlyOne){e(".tooltipstered").not(r.$el).each(function(t,n){var r=e(n),i=r.data("tooltipster-ns");e.each(i,function(e,t){var n=r.data(t),i=n.status(),s=n.option("autoClose");if(i!=="hidden"&&i!=="disappearing"&&s){n.hide()}})})}var i=function(){r.Status="shown";e.each(r.callbacks.show,function(e,t){t.call(r.$el)});r.callbacks.show=[]};if(r.Status!=="hidden"){var s=0;if(r.Status==="disappearing"){r.Status="appearing";if(l()){r.$tooltip.clearQueue().removeClass("tooltipster-dying").addClass("tooltipster-"+r.options.animation+"-show");if(r.options.speed>0)r.$tooltip.delay(r.options.speed);r.$tooltip.queue(i)}else{r.$tooltip.stop().fadeIn(i)}}else if(r.Status==="shown"){i()}}else{r.Status="appearing";var s=r.options.speed;r.bodyOverflowX=e("body").css("overflow-x");e("body").css("overflow-x","hidden");var o="tooltipster-"+r.options.animation,a="-webkit-transition-duration: "+r.options.speed+"ms; -webkit-animation-duration: "+r.options.speed+"ms; -moz-transition-duration: "+r.options.speed+"ms; -moz-animation-duration: "+r.options.speed+"ms; -o-transition-duration: "+r.options.speed+"ms; -o-animation-duration: "+r.options.speed+"ms; -ms-transition-duration: "+r.options.speed+"ms; -ms-animation-duration: "+r.options.speed+"ms; transition-duration: "+r.options.speed+"ms; animation-duration: "+r.options.speed+"ms;",f=r.options.minWidth?"min-width:"+Math.round(r.options.minWidth)+"px;":"",c=r.options.maxWidth?"max-width:"+Math.round(r.options.maxWidth)+"px;":"",h=r.options.interactive?"pointer-events: auto;":"";r.$tooltip=e('<div class="tooltipster-base '+r.options.theme+'" style="'+f+" "+c+" "+h+" "+a+'"><div class="tooltipster-content"></div></div>');if(l())r.$tooltip.addClass(o);r._content_insert();r.$tooltip.appendTo("body");r.reposition();r.options.functionReady.call(r.$el,r.$el,r.$tooltip);if(l()){r.$tooltip.addClass(o+"-show");if(r.options.speed>0)r.$tooltip.delay(r.options.speed);r.$tooltip.queue(i)}else{r.$tooltip.css("display","none").fadeIn(r.options.speed,i)}r._interval_set();e(t).on("scroll."+r.namespace+" resize."+r.namespace,function(){r.reposition()});if(r.options.autoClose){e("body").off("."+r.namespace);if(r.options.trigger=="hover"){if(u){setTimeout(function(){e("body").on("touchstart."+r.namespace,function(){r.hide()})},0)}if(r.options.interactive){if(u){r.$tooltip.on("touchstart."+r.namespace,function(e){e.stopPropagation()})}var p=null;r.$elProxy.add(r.$tooltip).on("mouseleave."+r.namespace+"-autoClose",function(){clearTimeout(p);p=setTimeout(function(){r.hide()},r.options.interactiveTolerance)}).on("mouseenter."+r.namespace+"-autoClose",function(){clearTimeout(p)})}else{r.$elProxy.on("mouseleave."+r.namespace+"-autoClose",function(){r.hide()})}}else if(r.options.trigger=="click"){setTimeout(function(){e("body").on("click."+r.namespace+" touchstart."+r.namespace,function(){r.hide()})},0);if(r.options.interactive){r.$tooltip.on("click."+r.namespace+" touchstart."+r.namespace,function(e){e.stopPropagation()})}}}}if(r.options.timer>0){r.timerHide=setTimeout(function(){r.timerHide=null;r.hide()},r.options.timer+s)}}})},_interval_set:function(){var t=this;t.checkInterval=setInterval(function(){if(e("body").find(t.$el).length===0||e("body").find(t.$elProxy).length===0||t.Status=="hidden"||e("body").find(t.$tooltip).length===0){if(t.Status=="shown"||t.Status=="appearing")t.hide();t._interval_cancel()}else{if(t.options.positionTracker){var n=t._repositionInfo(t.$elProxy),r=false;if(o(n.dimension,t.elProxyPosition.dimension)){if(t.$elProxy.css("position")==="fixed"){if(o(n.position,t.elProxyPosition.position))r=true}else{if(o(n.offset,t.elProxyPosition.offset))r=true}}if(!r){t.reposition()}}}},200)},_interval_cancel:function(){clearInterval(this.checkInterval);this.checkInterval=null},_content_set:function(e){if(typeof e==="object"&&e!==null&&this.options.contentCloning){e=e.clone(true)}this.Content=e},_content_insert:function(){var e=this,t=this.$tooltip.find(".tooltipster-content");if(typeof e.Content==="string"&&!e.options.contentAsHTML){t.text(e.Content)}else{t.empty().append(e.Content)}},_update:function(e){var t=this;t._content_set(e);if(t.Content!==null){if(t.Status!=="hidden"){t._content_insert();t.reposition();if(t.options.updateAnimation){if(l()){t.$tooltip.css({width:"","-webkit-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-moz-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-o-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-ms-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms",transition:"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms"}).addClass("tooltipster-content-changing");setTimeout(function(){if(t.Status!="hidden"){t.$tooltip.removeClass("tooltipster-content-changing");setTimeout(function(){if(t.Status!=="hidden"){t.$tooltip.css({"-webkit-transition":t.options.speed+"ms","-moz-transition":t.options.speed+"ms","-o-transition":t.options.speed+"ms","-ms-transition":t.options.speed+"ms",transition:t.options.speed+"ms"})}},t.options.speed)}},t.options.speed)}else{t.$tooltip.fadeTo(t.options.speed,.5,function(){if(t.Status!="hidden"){t.$tooltip.fadeTo(t.options.speed,1)}})}}}}else{t.hide()}},_repositionInfo:function(e){return{dimension:{height:e.outerHeight(false),width:e.outerWidth(false)},offset:e.offset(),position:{left:parseInt(e.css("left")),top:parseInt(e.css("top"))}}},hide:function(n){var r=this;if(n)r.callbacks.hide.push(n);r.callbacks.show=[];clearTimeout(r.timerShow);r.timerShow=null;clearTimeout(r.timerHide);r.timerHide=null;var i=function(){e.each(r.callbacks.hide,function(e,t){t.call(r.$el)});r.callbacks.hide=[]};if(r.Status=="shown"||r.Status=="appearing"){r.Status="disappearing";var s=function(){r.Status="hidden";if(typeof r.Content=="object"&&r.Content!==null){r.Content.detach()}r.$tooltip.remove();r.$tooltip=null;e(t).off("."+r.namespace);e("body").off("."+r.namespace).css("overflow-x",r.bodyOverflowX);e("body").off("."+r.namespace);r.$elProxy.off("."+r.namespace+"-autoClose");r.options.functionAfter.call(r.$el,r.$el);i()};if(l()){r.$tooltip.clearQueue().removeClass("tooltipster-"+r.options.animation+"-show").addClass("tooltipster-dying");if(r.options.speed>0)r.$tooltip.delay(r.options.speed);r.$tooltip.queue(s)}else{r.$tooltip.stop().fadeOut(r.options.speed,s)}}else if(r.Status=="hidden"){i()}return r},show:function(e){this._showNow(e);return this},update:function(e){return this.content(e)},content:function(e){if(typeof e==="undefined"){return this.Content}else{this._update(e);return this}},reposition:function(){var n=this;if(e("body").find(n.$tooltip).length!==0){n.$tooltip.css("width","");n.elProxyPosition=n._repositionInfo(n.$elProxy);var r=null,i=e(t).width(),s=n.elProxyPosition,o=n.$tooltip.outerWidth(false),u=n.$tooltip.innerWidth()+1,a=n.$tooltip.outerHeight(false);if(n.$elProxy.is("area")){var f=n.$elProxy.attr("shape"),l=n.$elProxy.parent().attr("name"),c=e('img[usemap="#'+l+'"]'),h=c.offset().left,p=c.offset().top,d=n.$elProxy.attr("coords")!==undefined?n.$elProxy.attr("coords").split(","):undefined;if(f=="circle"){var v=parseInt(d[0]),m=parseInt(d[1]),g=parseInt(d[2]);s.dimension.height=g*2;s.dimension.width=g*2;s.offset.top=p+m-g;s.offset.left=h+v-g}else if(f=="rect"){var v=parseInt(d[0]),m=parseInt(d[1]),y=parseInt(d[2]),b=parseInt(d[3]);s.dimension.height=b-m;s.dimension.width=y-v;s.offset.top=p+m;s.offset.left=h+v}else if(f=="poly"){var w=[],E=[],S=0,x=0,T=0,N=0,C="even";for(var k=0;k<d.length;k++){var L=parseInt(d[k]);if(C=="even"){if(L>T){T=L;if(k===0){S=T}}if(L<S){S=L}C="odd"}else{if(L>N){N=L;if(k==1){x=N}}if(L<x){x=L}C="even"}}s.dimension.height=N-x;s.dimension.width=T-S;s.offset.top=p+x;s.offset.left=h+S}else{s.dimension.height=c.outerHeight(false);s.dimension.width=c.outerWidth(false);s.offset.top=p;s.offset.left=h}}var A=0,O=0,M=0,_=parseInt(n.options.offsetY),D=parseInt(n.options.offsetX),P=n.options.position;function H(){var n=e(t).scrollLeft();if(A-n<0){r=A-n;A=n}if(A+o-n>i){r=A-(i+n-o);A=i+n-o}}function B(n,r){if(s.offset.top-e(t).scrollTop()-a-_-12<0&&r.indexOf("top")>-1){P=n}if(s.offset.top+s.dimension.height+a+12+_>e(t).scrollTop()+e(t).height()&&r.indexOf("bottom")>-1){P=n;M=s.offset.top-a-_-12}}if(P=="top"){var j=s.offset.left+o-(s.offset.left+s.dimension.width);A=s.offset.left+D-j/2;M=s.offset.top-a-_-12;H();B("bottom","top")}if(P=="top-left"){A=s.offset.left+D;M=s.offset.top-a-_-12;H();B("bottom-left","top-left")}if(P=="top-right"){A=s.offset.left+s.dimension.width+D-o;M=s.offset.top-a-_-12;H();B("bottom-right","top-right")}if(P=="bottom"){var j=s.offset.left+o-(s.offset.left+s.dimension.width);A=s.offset.left-j/2+D;M=s.offset.top+s.dimension.height+_+12;H();B("top","bottom")}if(P=="bottom-left"){A=s.offset.left+D;M=s.offset.top+s.dimension.height+_+12;H();B("top-left","bottom-left")}if(P=="bottom-right"){A=s.offset.left+s.dimension.width+D-o;M=s.offset.top+s.dimension.height+_+12;H();B("top-right","bottom-right")}if(P=="left"){A=s.offset.left-D-o-12;O=s.offset.left+D+s.dimension.width+12;var F=s.offset.top+a-(s.offset.top+s.dimension.height);M=s.offset.top-F/2-_;if(A<0&&O+o>i){var I=parseFloat(n.$tooltip.css("border-width"))*2,q=o+A-I;n.$tooltip.css("width",q+"px");a=n.$tooltip.outerHeight(false);A=s.offset.left-D-q-12-I;F=s.offset.top+a-(s.offset.top+s.dimension.height);M=s.offset.top-F/2-_}else if(A<0){A=s.offset.left+D+s.dimension.width+12;r="left"}}if(P=="right"){A=s.offset.left+D+s.dimension.width+12;O=s.offset.left-D-o-12;var F=s.offset.top+a-(s.offset.top+s.dimension.height);M=s.offset.top-F/2-_;if(A+o>i&&O<0){var I=parseFloat(n.$tooltip.css("border-width"))*2,q=i-A-I;n.$tooltip.css("width",q+"px");a=n.$tooltip.outerHeight(false);F=s.offset.top+a-(s.offset.top+s.dimension.height);M=s.offset.top-F/2-_}else if(A+o>i){A=s.offset.left-D-o-12;r="right"}}if(n.options.arrow){var R="tooltipster-arrow-"+P;if(n.options.arrowColor.length<1){var U=n.$tooltip.css("background-color")}else{var U=n.options.arrowColor}if(!r){r=""}else if(r=="left"){R="tooltipster-arrow-right";r=""}else if(r=="right"){R="tooltipster-arrow-left";r=""}else{r="left:"+Math.round(r)+"px;"}if(P=="top"||P=="top-left"||P=="top-right"){var z=parseFloat(n.$tooltip.css("border-bottom-width")),W=n.$tooltip.css("border-bottom-color")}else if(P=="bottom"||P=="bottom-left"||P=="bottom-right"){var z=parseFloat(n.$tooltip.css("border-top-width")),W=n.$tooltip.css("border-top-color")}else if(P=="left"){var z=parseFloat(n.$tooltip.css("border-right-width")),W=n.$tooltip.css("border-right-color")}else if(P=="right"){var z=parseFloat(n.$tooltip.css("border-left-width")),W=n.$tooltip.css("border-left-color")}else{var z=parseFloat(n.$tooltip.css("border-bottom-width")),W=n.$tooltip.css("border-bottom-color")}if(z>1){z++}var X="";if(z!==0){var V="",J="border-color: "+W+";";if(R.indexOf("bottom")!==-1){V="margin-top: -"+Math.round(z)+"px;"}else if(R.indexOf("top")!==-1){V="margin-bottom: -"+Math.round(z)+"px;"}else if(R.indexOf("left")!==-1){V="margin-right: -"+Math.round(z)+"px;"}else if(R.indexOf("right")!==-1){V="margin-left: -"+Math.round(z)+"px;"}X='<span class="tooltipster-arrow-border" style="'+V+" "+J+';"></span>'}n.$tooltip.find(".tooltipster-arrow").remove();var K='<div class="'+R+' tooltipster-arrow" style="'+r+'">'+X+'<span style="border-color:'+U+';"></span></div>';n.$tooltip.append(K)}n.$tooltip.css({top:Math.round(M)+"px",left:Math.round(A)+"px"})}return n},enable:function(){this.enabled=true;return this},disable:function(){this.hide();this.enabled=false;return this},destroy:function(){var t=this;t.hide();if(t.$el[0]!==t.$elProxy[0])t.$elProxy.remove();t.$el.removeData(t.namespace).off("."+t.namespace);var n=t.$el.data("tooltipster-ns");if(n.length===1){var r=typeof t.Content==="string"?t.Content:e("<div></div>").append(t.Content).html();t.$el.removeClass("tooltipstered").attr("title",r).removeData(t.namespace).removeData("tooltipster-ns").off("."+t.namespace)}else{n=e.grep(n,function(e,n){return e!==t.namespace});t.$el.data("tooltipster-ns",n)}return t},elementIcon:function(){return this.$el[0]!==this.$elProxy[0]?this.$elProxy[0]:undefined},elementTooltip:function(){return this.$tooltip?this.$tooltip[0]:undefined},option:function(e,t){if(typeof t=="undefined")return this.options[e];else{this.options[e]=t;return this}},status:function(){return this.Status}};e.fn[r]=function(){var t=arguments;if(this.length===0){if(typeof t[0]==="string"){var n=true;switch(t[0]){case"setDefaults":e.extend(i,t[1]);break;default:n=false;break}if(n)return true;else return this}else{return this}}else{if(typeof t[0]==="string"){var r="#*$~&";this.each(function(){var n=e(this).data("tooltipster-ns"),i=n?e(this).data(n[0]):null;if(i){if(typeof i[t[0]]==="function"){var s=i[t[0]](t[1],t[2])}else{throw new Error('Unknown method .tooltipster("'+t[0]+'")')}if(s!==i){r=s;return false}}else{throw new Error("You called Tooltipster's \""+t[0]+'" method on an uninitialized element')}});return r!=="#*$~&"?r:this}else{var o=[],u=t[0]&&typeof t[0].multiple!=="undefined",a=u&&t[0].multiple||!u&&i.multiple,f=t[0]&&typeof t[0].debug!=="undefined",l=f&&t[0].debug||!f&&i.debug;this.each(function(){var n=false,r=e(this).data("tooltipster-ns"),i=null;if(!r){n=true}else if(a){n=true}else if(l){console.log('Tooltipster: one or more tooltips are already attached to this element: ignoring. Use the "multiple" option to attach more tooltips.')}if(n){i=new s(this,t[0]);if(!r)r=[];r.push(i.namespace);e(this).data("tooltipster-ns",r);e(this).data(i.namespace,i)}o.push(i)});if(a)return o;else return this}}};var u=!!("ontouchstart"in t);var a=false;e("body").one("mousemove",function(){a=true})})(jQuery,window,document);;;(function($){$.fn.autogrow=function(opts){var that=$(this).css({overflow:'hidden',resize:'none'}),selector=that.selector,defaults={context:$(document),animate:true,speed:50,fixMinHeight:true,cloneClass:'autogrowclone',onInitialize:false};opts=$.isPlainObject(opts)?opts:{context:opts?opts:$(document)};opts=$.extend({},defaults,opts);that.each(function(i,elem){var min,clone;elem=$(elem);if(elem.is(':visible')||parseInt(elem.css('height'),10)>0){min=parseInt(elem.css('height'),10)||elem.innerHeight();}else{clone=elem.clone().addClass(opts.cloneClass).val(elem.val()).css({position:'absolute',visibility:'hidden',display:'block'});$('body').append(clone);min=clone.innerHeight();clone.remove();}
if(opts.fixMinHeight){elem.data('autogrow-start-height',min);}
elem.css('height',min);if(opts.onInitialize&&elem.length){resize.call(elem[0]);}});opts.context.on('keyup paste',selector,resize);function resize(e){var box=$(this),oldHeight=box.innerHeight(),newHeight=this.scrollHeight,minHeight=box.data('autogrow-start-height')||0,clone;if(oldHeight<newHeight){this.scrollTop=0;opts.animate?box.stop().animate({height:newHeight},opts.speed):box.innerHeight(newHeight);}else if(!e||e.which==8||e.which==46||(e.ctrlKey&&e.which==88)){if(oldHeight>minHeight){clone=box.clone().addClass(opts.cloneClass).css({position:'absolute',zIndex:-10,height:''}).val(box.val());box.after(clone);do{newHeight=clone[0].scrollHeight-1;clone.innerHeight(newHeight);}while(newHeight===clone[0].scrollHeight);newHeight++;clone.remove();box.focus();newHeight<minHeight&&(newHeight=minHeight);oldHeight>newHeight&&opts.animate?box.stop().animate({height:newHeight},opts.speed):box.innerHeight(newHeight);}else{box.innerHeight(minHeight);}}}
return that;}})(jQuery);jQuery(document).ready(function(){jQuery('.ap-tip').tooltipster({contentAsHTML:true});jQuery('#ap-conversation-scroll').scrollTop(0);jQuery('textarea.autogrow, textarea#post_content').autogrow({onInitialize:true});jQuery('.ap-categories-list li .ap-icon-arrow-down').click(function(e){e.preventDefault();jQuery(this).parent().next().slideToggle(200);});});function ap_chk_activity_scroll(e){if((jQuery('#ap-conversation-scroll .ap-no-more-message').length==0)){var elem=jQuery(e.currentTarget);if(elem[0].scrollHeight-elem.scrollTop()==elem.outerHeight()){APjs.site.loadMoreConversations(elem);}}};jQuery(document).ready(function($){if($('.wp_shortcodes_toggle').length){$(".togglec").hide();$(".wps_togglet").click(function(){$(this).toggleClass("toggleta").next(".togglec").slideToggle("normal");});}
if($('.wp_shortcodes_tabs').length){$('.wp_shortcodes_tabs').each(function(){var $this=$(this);$this.find('.tab_content').slice(1).hide();$this.find('ul.wps_tabs li:first').addClass('active');$this.find('ul.wps_tabs li a').click(function(e){e.preventDefault();var $this_a=$(this);var $tab=$this.find('#'+$this_a.data('tab'));if(!$tab.is(':visible')){$this.find('.tab_content').hide();$this_a.parent().addClass('active').siblings().removeClass('active');$tab.fadeIn(600);}});});}});